<!DOCTYPE html>
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.29+5 of 2017-05-18">
<link rel="stylesheet" type="text/css" href="cascmd_en.css">
<title>Approximating solutions of nonlinear second-order boundary value problems: bvpsolve
</title>
</head>
<body >
<a href="cascmd_en712.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en714.html"><img src="next_motif.gif" alt="Next"></a>
<hr>
<h3 id="sec1839" class="subsection">10.3.7  Approximating solutions of nonlinear second-order boundary value problems: <span style="font-family:monospace">bvpsolve</span>
<a id="hevea_default1299"></a></h3>
<p>The <span style="font-family:monospace">bvpsolve</span> command finds an approximate solution of a boundary value
problem 
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">y</span>″=<span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>,<span style="font-style:italic">y</span>,<span style="font-style:italic">y</span>′),   <span style="font-style:italic">y</span>(<span style="font-style:italic">a</span>)=α, <span style="font-style:italic">y</span>(<span style="font-style:italic">b</span>)=β 
</td></tr>
</table><p> 
on an interval [<span style="font-style:italic">a</span>,<span style="font-style:italic">b</span>]. The procedure uses the method of nonlinear
shooting which is based on Newton and Runge-Kutta methods. Values of
<span style="font-style:italic">y</span> and its first derivative <span style="font-style:italic">y</span>′ are approximated at points
<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>=<span style="font-style:italic">a</span>+<span style="font-style:italic">k</span> δ, where δ=<span style="font-style:italic">b</span>−<span style="font-style:italic">a</span>/<span style="font-style:italic">N</span> and <span style="font-style:italic">k</span>=0,1,…,<span style="font-style:italic">N</span>.
For the numeric tolerance (precision) threshold, the algorithm uses
<span style="font-family:monospace">epsilon</span> specified in the session settings in <span style="font-family:monospace">Xcas</span> (see
Section <a href="cascmd_en027.html#ssec%3Aconfcomp">2.5.7</a>, item <a href="cascmd_en027.html#enum%3Aeps">9</a>).</p><ul class="itemize"><li class="li-itemize">
<span style="font-family:monospace">bvpsolve</span> takes three mandatory arguments and four
optional arguments:
<ul class="itemize"><li class="li-itemize">
<span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>,<span style="font-style:italic">y</span>,<span style="font-style:italic">y</span>′), an expression involving an independent variable
<span style="font-style:italic">x</span>, a dependent variable <span style="font-style:italic">y</span> and <span style="font-style:italic">y</span>′.
</li><li class="li-itemize">[<span style="font-style:italic">x</span>=<span style="font-style:italic">a</span>..<span style="font-style:italic">b</span>,<span style="font-style:italic">y</span>], a list specifying the independent variable <span style="font-style:italic">x</span>,
its range [<span style="font-style:italic">a</span>,<span style="font-style:italic">b</span>] and the sought function <span style="font-style:italic">y</span>
</li><li class="li-itemize">[α,β], a list of the boundary values of <span style="font-style:italic">y</span>.
</li><li class="li-itemize">Optionally, <span style="font-style:italic">A</span>, an initial guess for <span style="font-style:italic">y</span>′(<span style="font-style:italic">a</span>) (by default, 
(β−α)/(<span style="font-style:italic">b</span>−<span style="font-style:italic">a</span>)).
</li><li class="li-itemize">Optionally, <span style="font-style:italic">N</span>, an integer greater than or equal to 2 (by
default 100).
</li><li class="li-itemize"><span style="font-family:monospace">output=</span><span style="font-style:italic">type</span> or
<span style="font-family:monospace">Output=</span><span style="font-style:italic">type</span>, the type of the output, where
<span style="font-style:italic">type</span> can be one of:
<ul class="itemize"><li class="li-itemize">
<span style="font-family:monospace">list</span>
</li><li class="li-itemize"><span style="font-family:monospace">diff</span> 
</li><li class="li-itemize"><span style="font-family:monospace">piecewise</span> 
</li><li class="li-itemize"><span style="font-family:monospace">spline</span>
</li></ul>
(By default <span style="font-family:monospace">list</span>).
</li><li class="li-itemize"><span style="font-family:monospace">limit=</span><span style="font-style:italic">M</span>, a positive integer for a limit for the
number of iterations before the procedure is stopped 
(by default there is no limit). 
</li></ul>
</li><li class="li-itemize"><span style="font-family:monospace">bvpsolve(</span><span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>,<span style="font-style:italic">y</span>,<span style="font-style:italic">y</span>′),[<span style="font-style:italic">x</span>=<span style="font-style:italic">a</span>..<span style="font-style:italic">b</span>,<span style="font-style:italic">y</span>],[α,β] ⟨,<span style="font-style:italic">A</span>,<span style="font-style:italic">N</span>,
<span style="font-family:monospace">output=</span><span style="font-style:italic">type</span>,<span style="font-family:monospace">limit=</span><span style="font-style:italic">M</span>⟩<span style="font-family:monospace">)</span>
returns, for the different output types:
<ul class="itemize"><li class="li-itemize">
<span style="font-family:monospace">list</span>, a list of pairs [<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>] where <span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>≈ <span style="font-style:italic">y</span>(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>),
</li><li class="li-itemize"><span style="font-family:monospace">diff</span>, a list of triples [<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span>′<sub><span style="font-style:italic">k</span></sub>], where <span style="font-style:italic">y</span>′<sub><span style="font-style:italic">k</span></sub>≈ <span style="font-style:italic">y</span>′(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>),
</li><li class="li-itemize"><span style="font-family:monospace">piecewise</span>, a piecewise linear interpolation of the
points (<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>),
</li><li class="li-itemize"><span style="font-family:monospace">spline</span>, a piecewise spline interpolation of the
points (<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>), based on the values <span style="font-style:italic">y</span>′<sub><span style="font-style:italic">k</span></sub> computed in the
process. 
</li></ul>
</li></ul><p>Note that the shooting method is sensitive to roundoff errors and may
fail to converge in some cases, especially when <span style="font-style:italic">y</span> is a rapidly
increasing function. In the absence of convergence or if the maximum
number of iterations is exceeded, <span style="font-family:monospace">bvpsolve</span> returns
<span style="font-family:monospace">undef</span>. However, if the output type is <span style="font-family:monospace">list</span> or
<span style="font-family:monospace">piecewise</span> and if <span style="font-style:italic">N</span>&gt;2, a slower but more stable
finite-difference method (which approximates only the function <span style="font-style:italic">y</span>) is
tried first.</p><p>Sometimes setting an initial guess <span style="font-style:italic">A</span> for <span style="font-style:italic">y</span>′(<span style="font-style:italic">a</span>) to a suitable value
may help the shooting algorithm to converge or to converge faster.</p><h4 id="sec1840" class="subsubsection">Examples</h4>
<ul class="itemize"><li class="li-itemize">
Solve the problem
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">y</span>″=</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center">1</td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center">8</td></tr>
</table></td><td class="dcell"> (32+2 <span style="font-style:italic">x</span><sup>3</sup>−<span style="font-style:italic">y</span> <span style="font-style:italic">y</span>′),   1≤ <span style="font-style:italic">x</span>≤ 3
</td></tr>
</table> with
boundary conditions <span style="font-style:italic">y</span>(1)=17 and <span style="font-style:italic">y</span>(3)=43/3. 
Use <span style="font-style:italic">N</span>=20, which gives an <span style="font-style:italic">x</span>-step of 0.01.<br>
<span style="font-style:italic">Input:</span>
<div class="center">
<span style="font-family:monospace">bvpsolve((32+2x^3-y*y’)/8,[x=1..3,y],[17,43/3],20)</span>
</div>
The output is shown in Table <a href="#tab%3Abvp">10.1</a> (the middle two columns)
alongside with the values <span style="font-style:italic">y</span>(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>) of the exact solution <span style="font-style:italic">y</span>=<span style="font-style:italic">x</span><sup>2</sup>+16/<span style="font-style:italic">x</span>
(the fourth column).
<blockquote class="table"><div class="center"><div class="center"><hr style="width:80%;height:2"></div>
<table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> </span><span style="font-size:small"><span style="font-style:italic">k</span></span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small"><span style="font-style:italic">x</span></span><sub><span style="font-size:small"><span style="font-style:italic">k</span></span></sub></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small"><span style="font-style:italic">y</span></span><sub><span style="font-size:small"><span style="font-style:italic">k</span></span></sub></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small"><span style="font-style:italic">y</span></span><span style="font-size:small">(</span><span style="font-size:small"><span style="font-style:italic">x</span></span><sub><span style="font-size:small"><span style="font-style:italic">k</span></span></sub><span style="font-size:small">)</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 0</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.0</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">17.0</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">17.0</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 1</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.1</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">15.7554961579</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">15.7554545455</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 2</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.2</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">14.7733911821</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">14.7733333333</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 3</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.3</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.9977543159</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.9976923077</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 4</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.4</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.388631813</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.3885714286</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 5</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.5</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.9167227424</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.9166666667</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 6</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.6</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.5600506483</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.56</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 7</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.7</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.3018096101</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.3017647059</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 8</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.8</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.1289281414</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.1288888889</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 9</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">1.9</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.0310865274</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.0310526316</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 10</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.0</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.0000289268</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.0</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 11</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.1</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.0290719981</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.029047619</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 12</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.2</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.1127475278</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.1127272727</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 13</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.3</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.2465382803</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.2465217391</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 14</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.4</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.4266798825</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.4266666667</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 15</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.5</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.650010254</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.65</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 16</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.6</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.9138537834</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">12.9138461538</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 17</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.7</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.2159312426</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.2159259259</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 18</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.8</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.5542890043</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.5542857143</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 19</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">2.9</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.9272429048</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">13.9272413793</span></td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" ><span style="font-size:small"> 20</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">3.0</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">14.3333333333</span></td><td style="text-align:left;border:solid 1px;white-space:nowrap" ><span style="font-size:small">14.3333333333</span></td></tr>
</table><span style="font-size:small">
</span><div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" ><span style="font-size:small">Table 10.1: approximate and true values of the function </span><span style="font-size:small"><span style="font-style:italic">y</span></span><span style="font-size:small">=</span><span style="font-size:small"><span style="font-style:italic">x</span></span><sup><span style="font-size:small">2</span></sup><span style="font-size:small">+16/</span><span style="font-size:small"><span style="font-style:italic">x</span></span><span style="font-size:small"> on </span><span style="font-size:small">[1,3]</span><a id="tab:bvp"></a></td></tr>
</table></div><span style="font-size:small">
</span><div class="center"><hr style="width:80%;height:2"></div></div></blockquote>
</li><li class="li-itemize">Solve
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">y</span>″=</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center"><span style="font-style:italic">x</span><sup>2</sup> (<span style="font-style:italic">y</span>′)<sup>2</sup>−9 <span style="font-style:italic">y</span><sup>2</sup>+4 <span style="font-style:italic">x</span><sup>6</sup></td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center"><span style="font-style:italic">x</span><sup>5</sup></td></tr>
</table></td><td class="dcell">,   1≤ <span style="font-style:italic">x</span>≤ 2, 
</td></tr>
</table> 
with the boundary conditions <span style="font-style:italic">y</span>(1)=0 and <span style="font-style:italic">y</span>(2)=ln256.
Obtain the solution as a piecewise spline interpolation for <span style="font-style:italic">N</span>=10 and
estimate the absolute error <span style="font-family:monospace">err</span> of the approximation using
the exact solution <span style="font-style:italic">y</span>=<span style="font-style:italic">x</span><sup>3</sup> ln<span style="font-style:italic">x</span> and the <span style="font-family:monospace">romberg</span> command for
numerical integration. You need to explicitly set an initial guess
<span style="font-style:italic">A</span> for the value <span style="font-style:italic">y</span>′(1) because the algorithm fails to converge with the
default guess <span style="font-style:italic">A</span>=ln256≈ 5.545. Therefore let <span style="font-style:italic">A</span>=1
instead.<br>
<span style="font-style:italic">Input:</span>
<div class="center">
<table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" > <span style="font-family:monospace">f:=(x^2*diff(y(x),x)^2-9*y(x)^2+4*x^6)/x^5:;</span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <span style="font-family:monospace">p:=bvpsolve(f,[x=1..2,y],[0,ln(256),1],10,output=spline):;</span></td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <span style="font-family:monospace">err:=sqrt(romberg((p-x^3*ln(x))^2,x=1..2))</span>
</td></tr>
</table>
</div>
<span style="font-style:italic">Output:</span>
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">3.27751904973×10<sup>−6</sup>
</td></tr>
</table>
Note that, if the output type was set to <span style="font-family:monospace">list</span> or
<span style="font-family:monospace">piecewise</span>, the solution would have been found even without
specifying an initial guess for <span style="font-style:italic">y</span>′(1) because the algorithm would
automatically apply the alternative finite-difference method, which
converges.
</li></ul>
<hr>
<a href="cascmd_en712.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en714.html"><img src="next_motif.gif" alt="Next"></a>
</body>
</html>
